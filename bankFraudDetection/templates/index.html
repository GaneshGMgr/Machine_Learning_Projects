<!DOCTYPE html>
<html>
<head>
    <title>Upload CSV or Excel File</title>
</head>
<body>
    <h1>Upload File for Prediction</h1>
    <form id="uploadForm" action="/predict" method="post" enctype="multipart/form-data">
        <input type="file" name="file" required>
        <input type="submit" value="Upload">
    </form>
    <div id="results"></div>

    <script>
        document.querySelector('#uploadForm').onsubmit = async function(e) {
            e.preventDefault();
            const fileInput = document.querySelector('input[type="file"]');
            const formData = new FormData();
            formData.append('file', fileInput.files[0]);
            
            try {
                const response = await fetch('/predict', {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }

                const results = await response.json();
                displayResults(results);
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('results').innerHTML = 'Error: ' + error.message;
            }
        };

        function displayResults(results) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '';

            const table = document.createElement('table');
            const headerRow = document.createElement('tr');
            
            // Create table headers
            const headers = Object.keys(results[0]);
            headers.forEach(header => {
                const headerCell = document.createElement('th');
                headerCell.textContent = header;
                headerRow.appendChild(headerCell);
            });
            table.appendChild(headerRow);

            // Create table rows
            results.forEach(result => {
                const row = document.createElement('tr');
                headers.forEach(header => {
                    const cell = document.createElement('td');
                    cell.textContent = result[header];
                    row.appendChild(cell);
                });
                table.appendChild(row);
            });

            resultsDiv.appendChild(table);
        }
    </script>
</body>
</html>
